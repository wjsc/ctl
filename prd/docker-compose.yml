version: '3'
services:
  front_prd:
    container_name: "front_prd"
    environment:
      TZ: "America/Argentina/Buenos_Aires"
      NODE_ENV: "production"
      NPM_CONFIG_PREFIX: "/home/node/.npm-global"
    build: ./front
    ports:
      - "80:3000"
    logging:
      driver: gcplogs
  api_prd:
    container_name: "api_prd"
    environment:
      TZ: "America/Argentina/Buenos_Aires"
      NODE_ENV: "production"
      DB_HOST: "db_prd"
      ORIGIN: "*"
    build: ./api
    ports:
      - "3001:3001"
    logging:
      driver: gcplogs
  db_prd:
    container_name: "db_prd"
    image: mongo:3.4.0
    environment:
      - MONGO_DATA_DIR=/data/db
      - MONGO_LOG_DIR=/dev/null
    ports:
        - 27017:27017
    command: mongod --smallfiles --logpath=/dev/null 
    logging:
      driver: gcplogs
  static_prd:
    container_name: "static_prd"
    environment:
      TZ: "America/Argentina/Buenos_Aires"
      NODE_ENV: "production"
    build: ./static
    ports:
      - "3002:3002"
    volumes:
      - /home/elballetdelosimbeciles/.catalogue/files/:/app/data:ro
    logging:
      driver: gcplogs
networks:
  default:
    driver: custom-driver-1